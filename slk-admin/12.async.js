(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[12],{OjdN:function(e,t,n){"use strict";var a=n("TqRt"),l=n("284h");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("IzEo");var o=a(n("bx4M"));n("g9YV");var i=a(n("wCAj"));n("+L6B");var c=a(n("2/Rp"));n("2qtc");var d=a(n("kLXV"));n("miYZ");var s=a(n("tsqr")),f=a(n("PJYZ"));n("fOrg");var u=a(n("+KLJ")),r=a(n("lwsE")),g=a(n("W8MJ")),m=a(n("a1gu")),h=a(n("Nsbk")),p=a(n("7W2i"));n("5NDa");var v,y,C=a(n("5rEg")),b=l(n("q1tI")),I=n("MuoO"),k=a(n("zHco")),E=n("a2tt"),S=(C.default.TextArea,function(e){function t(){var e,n;(0,r.default)(this,t);for(var a=arguments.length,l=new Array(a),o=0;o<a;o++)l[o]=arguments[o];return n=(0,m.default)(this,(e=(0,h.default)(t)).call.apply(e,[this].concat(l))),n.state={visible:!0},n.handleClose=function(){n.setState({visible:!1})},n}return(0,p.default)(t,e),(0,g.default)(t,[{key:"render",value:function(){return b.default.createElement("div",null,this.state.visible?b.default.createElement(u.default,{message:"\u8bf7\u6ce8\u610f\uff1a\u91cd\u8f7d\u914d\u7f6e\u4f1a\u4ece\u670d\u52a1\u5668\u62c9\u53d6\u914d\u7f6e\u8986\u76d6\u6389\u4fee\u6539\uff0c\u4fee\u6539\u914d\u7f6e\u540e\u8bf7\u624b\u52a8\u70b9\u51fb\u4fdd\u5b58\u6309\u94ae\u786e\u8ba4\u63d0\u4ea4",type:"warning",closable:!0,afterClose:this.handleClose}):null,b.default.createElement("p",null))}}]),t}(b.default.Component)),N=function(e){function t(e){var n;return(0,r.default)(this,t),n=(0,m.default)(this,(0,h.default)(t).call(this,e)),n.uploadFile=n.uploadFile.bind((0,f.default)((0,f.default)(n))),n.image_callback=n.image_callback.bind((0,f.default)((0,f.default)(n))),n}return(0,p.default)(t,e),(0,g.default)(t,[{key:"getBase64",value:function(e,t){var n=new FileReader;n.readAsDataURL(e),n.onload=function(){console.log(n.result),t(n.result)},n.onerror=function(e){console.log("Error: ",e)}}},{key:"image_callback",value:function(e){this.props.handleUploadFile(e)}},{key:"uploadFile",value:function(e){var t=e.target.files[0];if(console.log(t),console.log(t.size),t.size>1e5)return s.default.warning("\u8bf7\u4e0a\u4f20\u5c0f\u4e8e100KB\u7684\u56fe\u7247",.8),void(e.target.value=null);if(this.getBase64(t,this.image_callback),t){var n=new FormData;n.append("file",t)}}},{key:"render",value:function(){return b.default.createElement("span",null,b.default.createElement("input",{type:"file",name:"myFile",onChange:this.uploadFile}))}}]),t}(b.default.Component),w=(v=(0,I.connect)(function(e){var t=e.configure,n=e.loading;return{configure:t,loading:n.effects["configure/fetchIconConfig"]}}),v(y=function(e){function t(e){var n;return(0,r.default)(this,t),n=(0,m.default)(this,(0,h.default)(t).call(this,e)),n.state={iconConfig:"[]",modifyVisible:!1,deleteVisible:!1,addVisible:!1,addIconName:""},n.handleModifyConfig=function(e){console.log("====>",e.target.value),n.setState({iconConfig:e.target.value})},n.handleModifyIconName=function(e){n.setState({newIconName:e.target.value}),console.log("newIconName: ",e.target.value)},n.handleAddIconName=function(e){n.setState({addIconName:e.target.value}),console.log(e.target.value)},n.handleFetchIconConfig=function(e){var t=n.props.dispatch;console.log("handlerFetchIconConfig clicked"),t({type:"configure/fetchIconConfig",callback:function(){"click"===e&&s.default.success("\u83b7\u53d6\u914d\u7f6e\u6210\u529f",.8)}})},n.handleSaveIconConfig=function(){console.log("want save config");var e=n.props.dispatch;e({type:"configure/saveIconConfig",payload:{config:JSON.parse(n.state.iconConfig)},callback:function(){s.default.success("\u4fdd\u5b58\u914d\u7f6e\u6210\u529f",.8)}})},n.showModifyModal=function(e){n.setState({modifyVisible:!0}),n.setState({modifyIconName:e}),n.setState({newIconName:e}),console.log("modal:",e)},n.handleModifyOk=function(){n.setState({modifyVisible:!1}),(n.state.base64img||n.state.modifyIconName!==n.state.newIconName)&&n.updateTheIcon(n.state.modifyIconName,n.state.base64img),console.log("ok"),console.log("modifyIconName",n.state.modifyIconName)},n.handleModifyCancel=function(){n.setState({modifyVisible:!1}),n.setState({base64img:""})},n.showDeleteModal=function(e){n.setState({deleteVisible:!0}),n.setState({deleteIconName:e})},n.showAddModal=function(){n.setState({addVisible:!0})},n.addIcon=function(){var e=JSON.parse(n.state.iconConfig);e.push({name:n.state.addIconName,icon:n.state.base64img}),n.setState({iconConfig:E.plain(e)})},n.handleAddOk=function(){n.setState({addVisible:!1}),n.addIcon(),console.log("delete ok")},n.handleAddCancel=function(){n.setState({addVisible:!1}),console.log("delete cancel")},n.handleDeleteOk=function(){n.setState({deleteVisible:!1}),n.deleteIcon(n.state.deleteIconName),console.log("delete ok")},n.handleDeleteCancel=function(){n.setState({deleteVisible:!1}),console.log("delete cancel")},n.handleUploadFile=function(e){n.setState({base64img:e})},n.updateTheIcon=function(e,t){console.log("updateTheIcon: ",e,t);var a=[];JSON.parse(n.state.iconConfig).map(function(l){if(l.name===e){console.log("lalala~");var o=n.state.newIconName,i=t||l.icon;a.push({name:o,icon:i})}else a.push(l)}),n.setState({iconConfig:E.plain(a)})},n.deleteIcon=function(e){var t=[];JSON.parse(n.state.iconConfig).map(function(n){n.name!==e&&t.push(n)}),n.setState({iconConfig:E.plain(t)})},n.getIconData=function(){var e=[];return JSON.parse(n.state.iconConfig).map(function(t){e.push({key:t.name,name:t.name,icon:t.icon})}),e},n}return(0,p.default)(t,e),(0,g.default)(t,[{key:"componentDidMount",value:function(){console.log("componentDidMount"),this.handleFetchIconConfig("default")}},{key:"componentWillReceiveProps",value:function(e){this.props.configure.iconConfig===e.configure.iconConfig&&this.props.configure.iconConfig===this.state.iconConfig||void 0!==e.configure.iconConfig&&""!==e.configure.iconConfig&&(console.log("setState iconConfig"),console.log(e.configure.iconConfig),this.setState({iconConfig:E.plain(e.configure.iconConfig)}))}},{key:"render",value:function(){var e=this,t=this.props.loading,n=[{title:"\u540d\u79f0",dataIndex:"name",key:"name"},{title:"\u56fe\u6807",dataIndex:"icon",key:"icon",render:function(e){return b.default.createElement("img",{src:e,alt:"",style:{width:"50px",height:"50px",borderRadius:"50%"}})}},{title:"\u64cd\u4f5c",key:"action",render:function(t,n){var a=t.name;return b.default.createElement("div",null,b.default.createElement("a",{onClick:e.showModifyModal.bind(e,a)},"\u4fee\u6539"),b.default.createElement("a",{onClick:e.showDeleteModal.bind(e,a),style:{marginLeft:"12px"}},"\u5220\u9664"))}}];return b.default.createElement(k.default,{title:"SmartLinkey \u56fe\u6807\u914d\u7f6e"},b.default.createElement(o.default,{bordered:!1,loading:t},b.default.createElement(d.default,{title:"\u4fee\u6539\u914d\u7f6e",visible:this.state.modifyVisible,onOk:this.handleModifyOk,onCancel:this.handleModifyCancel,width:630},"\u56fe\u6807\u540d\u79f0 ",b.default.createElement("span",{style:{color:"red",fontSize:"10px"}},"(* \u4ec5\u652f\u6301\u8f93\u5165\u82f1\u6587)"),": ",b.default.createElement(C.default,{value:this.state.newIconName,onChange:function(t){e.handleModifyIconName(t)}}),b.default.createElement("br",null),b.default.createElement("br",null),"\u4e0a\u4f20\u56fe\u6807\uff1a",b.default.createElement(N,{handleUploadFile:this.handleUploadFile.bind(this)})),b.default.createElement(d.default,{title:"\u5220\u9664\u914d\u7f6e",visible:this.state.deleteVisible,onOk:this.handleDeleteOk,onCancel:this.handleDeleteCancel},b.default.createElement("p",null,"\u786e\u8ba4\u5220\u9664\u540d\u4e3a[",this.state.deleteIconName,"]\u7684\u914d\u7f6e\uff1f")),b.default.createElement(d.default,{title:"\u6dfb\u52a0\u914d\u7f6e",visible:this.state.addVisible,onOk:this.handleAddOk,onCancel:this.handleAddCancel},"\u56fe\u6807\u540d\u79f0 ",b.default.createElement("span",{style:{color:"red",fontSize:"10px"}},"(* \u4ec5\u652f\u6301\u8f93\u5165\u82f1\u6587)"),"\uff1a",b.default.createElement(C.default,{type:"text",value:this.state.addIconName,onChange:function(t){e.handleAddIconName(t)}}),b.default.createElement("br",null),b.default.createElement("br",null),"\u4e0a\u4f20\u56fe\u6807\uff1a",b.default.createElement(N,{handleUploadFile:this.handleUploadFile.bind(this)})),b.default.createElement(S,null),b.default.createElement(c.default,{type:"primary",onClick:this.showAddModal,style:{marginLeft:"8px"}},"\u6dfb\u52a0"),b.default.createElement(i.default,{dataSource:this.getIconData(),columns:n}),b.default.createElement(c.default,{type:"primary",onClick:this.handleFetchIconConfig.bind(this,"click"),style:{marginLeft:"8px",marginTop:"8px"}},"\u91cd\u8f7d\u914d\u7f6e"),b.default.createElement(c.default,{type:"primary",onClick:this.handleSaveIconConfig,style:{marginLeft:"8px",marginTop:"8px"}},"\u4fdd\u5b58\u914d\u7f6e")))}}]),t}(b.Component))||y),M=w;t.default=M}}]);